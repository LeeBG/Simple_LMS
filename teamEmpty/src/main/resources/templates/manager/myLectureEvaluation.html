<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<!--내 강의 평가-->
<head th:insert="layout/managerHeader :: head"></head>
<style>
    .q4Content, .q5Content {
        display: none;
    }
    .evaluationRow {
        padding: 10px 5px;
        border: 1px solid black;
        margin: 10px;
    }
    .evaluationContent {
        padding: 5px;
        border: 1px solid grey;
        margin: 10px 0;
    }
</style>
<body>
<header th:insert="layout/managerHeader :: header"></header>
<main>
    <div class="container my-5 min-height">
        <h2 th:text="${lecture.getName()+' 강의 평가내역'}"></h2>
        <hr/>
        <div class="evaluationRow mt-2">
            <span>강의 내용이 강의 계획서대로 진행되었다.</span>
            <div class="evaluationContent">
                <span>A : <span th:text="${total['q1']['1'] != null ? total['q1']['1'] : 0} + '명 '"></span></span>
                <span>C : <span th:text="${total['q1']['3'] != null ? total['q1']['3'] : 0} + '명 '"></span></span>
                <span>D : <span th:text="${total['q1']['4'] != null ? total['q1']['4'] : 0} + '명 '"></span></span>
                <span>E : <span th:text="${total['q1']['5'] != null ? total['q1']['5'] : 0} + '명 '"></span></span>
                <span>B : <span th:text="${total['q1']['2'] != null ? total['q1']['2'] : 0} + '명 '"></span></span>
            </div>
        </div>
        <div class="evaluationRow">
            <span>나는 이 수업을 전체적으로 우수하다고 평가한다.</span>
            <div class="evaluationContent">
                <span>A : <span th:text="${total['q2']['1'] != null ? total['q2']['1'] : 0} + '명 '"></span></span>
                <span>B : <span th:text="${total['q2']['2'] != null ? total['q2']['2'] : 0} + '명 '"></span></span>
                <span>C : <span th:text="${total['q2']['3'] != null ? total['q2']['3'] : 0} + '명 '"></span></span>
                <span>D : <span th:text="${total['q2']['4'] != null ? total['q2']['4'] : 0} + '명 '"></span></span>
                <span>E : <span th:text="${total['q2']['5'] != null ? total['q2']['5'] : 0} + '명 '"></span></span>
            </div>
        </div>
        <div class="evaluationRow">
            <span>나는 이 수업을 통하여 많은 지식을 얻었다.</span>
            <div class="evaluationContent">
                <span>A : <span th:text="${total['q3']['1'] != null ? total['q3']['1'] : 0} + '명 '"></span></span>
                <span>B : <span th:text="${total['q3']['2'] != null ? total['q3']['2'] : 0} + '명 '"></span></span>
                <span>C : <span th:text="${total['q3']['3'] != null ? total['q3']['3'] : 0} + '명 '"></span></span>
                <span>D : <span th:text="${total['q3']['4'] != null ? total['q3']['4'] : 0} + '명 '"></span></span>
                <span>E : <span th:text="${total['q3']['5'] != null ? total['q3']['5'] : 0} + '명 '"></span></span>
            </div>
        </div>
        <div class="evaluationRow">
            <span>개선 사항 및 교수님께 하고 싶은 말이 있다면 적어주시기 바랍니다.</span>
            <div class="evaluationContent">
                <th:block th:each="row : ${evaluation}">
                    <div class="q4Content" th:text="${row.q4}"></div>
                </th:block>
            </div>
            <div id="pagination_p4">
                <button class="btn btn-success" onclick="previousPage('q4')">이전</button>
                <span id="currentPage_q4">1 / 1</span>
                <button class="btn btn-success" onclick="nextPage('q4')">다음</button>
            </div>
        </div>

        <div class="evaluationRow">
            <span>개선 사항 및 교수님께 하고 싶은 말이 있다면 적어주시기 바랍니다.</span>
            <div class="evaluationContent">
                <th:block th:each="row : ${evaluation}">
                    <div class="q5Content" th:text="${row.q5}"></div>
                </th:block>
            </div>
            <div id="pagination_p5">
                <button class="btn btn-success" onclick="previousPage('q5')">이전</button>
                <span id="currentPage_q5">1 / 1</span>
                <button class="btn btn-success" onclick="nextPage('q5')">다음</button>
            </div>
        </div>

        <div class="my-2">
            <button class="btn btn-primary" onclick="javascript:history.go(-1)">돌아가기</button>
        </div>
    </div>
</main>
<script>
    let currentPage_q4 = 1;
    let currentPage_q5 = 1;
    const itemsPerPage = 5;
    const q4Contents = document.querySelectorAll('.q4Content');
    const q5Contents = document.querySelectorAll('.q5Content');

    function showItems(contentType) {
        const contents = (contentType === 'q4') ? q4Contents : q5Contents;
        const currentPage = (contentType === 'q4') ? currentPage_q4 : currentPage_q5;
        const maxPage = Math.ceil(contents.length / itemsPerPage);

        const currentPageElement = document.getElementById(`currentPage_${contentType}`);
        currentPageElement.textContent = `${currentPage} / ${maxPage}`;

        const startIndex = (currentPage - 1) * itemsPerPage;
        const endIndex = startIndex + itemsPerPage;

        contents.forEach((content, index) => {
            content.style.display = (index >= startIndex && index < endIndex) ? 'block' : 'none';
        });
    }

    function previousPage(contentType) {
        const currentPage = (contentType === 'q4') ? currentPage_q4 : currentPage_q5;
        if (currentPage > 1) {
            (contentType === 'q4') ? currentPage_q4-- : currentPage_q5--;
            showItems(contentType);
        }
    }

    function nextPage(contentType) {
        const contents = (contentType === 'q4') ? q4Contents : q5Contents;
        const currentPage = (contentType === 'q4') ? currentPage_q4 : currentPage_q5;
        const maxPage = Math.ceil(contents.length / itemsPerPage);

        if (currentPage < maxPage) {
            (contentType === 'q4') ? currentPage_q4++ : currentPage_q5++;
            showItems(contentType);
        }
    }

    // Show initial items
    showItems('q4');
    showItems('q5');
</script>
<footer th:insert="layout/managerHeader :: footer"></footer>
</body>
</html>